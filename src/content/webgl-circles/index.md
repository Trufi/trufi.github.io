---
title: 'WebGL рисует не только треугольники'
date: '2015-10-16'
description: 'Заметка о том, что WebGL может рисовать не только триангулированные объекты'
---

_Возможно, суровые бородатые дядьки, которые вовсю разрабатывают на OpenGL, закидают меня помидорами, но когда я узнал об этом, радовался как маленький ребёнок._

На протяжении последних двух месяцев я считал, что WebGL только и умеет, что рисовать треугольники.

<img src="./triangle.svg" alt="Треугольник" style="width: 50%" />

_Да, треугольники, и больше ничего._

Например, чтобы нарисовать квадрат, ему нужно два треугольника:

<img src="./square.svg" alt="Квадрат из двух треугольников" style='width: 50%' />

А чтобы нарисовать круг, придётся немного попотеть! И всё равно, это будет не совсем круг:

<img src="./circle.svg" alt="Триангуляция круга" style='width: 50%' />

_Сколько на картинке треугольников? 18!_

Но неожиданно оказывается, что есть более простой способ:

<img class="spoiler" style="width: 200px;" src="./one_circle.svg" alt="Круг, нарисованный простым способом">

_Как вы думаете, сколько здесь используется треугольников?_

<img style="width: 200px;" src="./one_triangle.svg" alt="Один треугольник">

_Всего 1!_

### Всё просто

Мы знаем, что фрагментый шейдер вычисляется для каждого пикселя, а атрибуты, переданные в него через вершинный шейдер, линейно интерполируются между вершинами треугольника.

Значит, можно задать специальную систему координат, в которой укажем местоположение вершин треугольника и передадим их в шейдеры. Точно так же, как передаются uv-координаты при отрисовке текстуры.

<img src="./coord.svg" alt="Система координат" width="200">

Получается, что когда вызывается фрагментый шейдер, мы знаем положение пикселя в новой системе координат и можем на их основе вычислить цвет.

На примере выше мы говорим, что если пиксель находится в круге с центром (Cx, Cy) и радиусом R, т.е.

<img src="./formula.svg" alt="(X - Cx)^2 + (Y - Cy)^2 < R^2" style="width: 300px; height: 40px;">

то закрашиваем его в синий цвет.

Вместо круга можно придумать что-нибудь более интересное:

<iframe src="./wheel.html" width="600" height="400"></iframe>

###Полезности

- [Cтраница](./circle.html) и [исходник](http://trufi.github.io/circle.html) первого примера с кругом
- [Cтраница](./wheel.html) и [исходник](http://trufi.github.io/wheel.html) второго примера с шестерёнкой
- [GPU Gems 3: Сhapter 25](http://http.developer.nvidia.com/GPUGems3/gpugems3_ch25.html) объясняется как рисовать тем же способом векторные изображения
